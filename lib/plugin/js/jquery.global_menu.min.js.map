{"version":3,"file":"jquery.global_menu.min.js","sources":["plugin/js/jquery.global_menu.js"],"sourcesContent":["(function($) {\n  'use strict';\n\n  let GlobalMenu = {};\n  GlobalMenu = (function(elem, settings) {\n    this.$elem = elem;\n\n    // fixed value settings\n    this.settings = $.extend(true, {\n      elem : elem\n      , gm_area : 'gm_area'\n      , gm_inner : 'gm_inner'\n      , submenu : {\n        is_active : false\n        , accordion : {\n          item : 'gm_accordion'\n          , body : 'gm_accordion_body'\n          , menu_width : {\n            is_active : false\n            , min_width : 220\n            , max_width : 350\n          }\n        }\n        , mega : {\n          item : 'gm_mega'\n          , body : 'gm_mega_body'\n        }\n      }\n      , scroll_fix : {\n        is_active : false\n        , active_y : parseInt($(elem).offset().top + $(elem).height())\n        , is_fixed : 'is_fixed'\n        , view_out : {\n          is_active : false\n          , is_view_out : 'is_view_out'\n        }\n      }\n    }, settings);\n\n\n    this.init_on_load();\n  });\n\n\n  /** ----------------------------------------------------------------------------\n   * init on load\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.init_on_load = function() {\n    let _ = this,\n        _s = _.settings;\n\n    // prevent animation\n    _.$elem.addClass('is_preloaded');\n\n    // add scroll event when scroll fix is active\n    if(_.settings.scroll_fix.is_active) {\n      $(window).trigger('scroll');\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * global menu\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.global_menu = function() {\n    let _ = this,\n        _s = _.settings;\n\n    if(_s.submenu.is_active){\n      // job for submenu\n      _.add_submenu_job();\n\n      if(_s.submenu.accordion.menu_width.is_active){\n        // job for accordion　menu　width\n        _.change_accordion_menu_width();\n      }\n    }\n\n    if(_s.scroll_fix.is_active){\n      if(_s.scroll_fix.view_out.is_active){\n        _.gm_position_fixed_view_out();\n      }else{\n        _.gm_position_fixed();\n      }\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * sub menu\n   *----------------------------------------------------------------------------*/\n  /** --------------------------------------\n   * sub menu\n   *--------------------------------------*/\n  GlobalMenu.prototype.init_submenu = function(event_obj) {\n    let _ = this,\n        _s = _.settings;\n\n    $(_.$elem)\n      .find(_.get_submenu())\n        .each(function(){\n\n          if(typeof event_obj !== 'undefined' && this == event_obj) return;\n\n          $(this)\n            .removeClass('is_show');\n    });\n  };\n\n  GlobalMenu.prototype.add_submenu_job = function() {\n    let _ = this,\n        _s = _.settings;\n\n    _.submenu_job[\n      _.is_touch_display()?\n          'toggle' : 'show'\n    ]();\n\n    $(_.$elem)\n      .on('mouseleave', function(){\n        _.init_submenu();\n    });\n\n  };\n\n  GlobalMenu.prototype.submenu_job.toggle = function() {\n    let _ = this,\n        _s = _.settings,\n        flag = true;\n\n    $(_.$elem)\n      .find(_.get_submenu())\n        .on('click', function(){\n          if(flag == false) return;\n          flag = false;\n          setTimeout(function(){ flag = true; }, 500);\n\n          _.init_submenu(this);\n\n          $(this)\n            .toggleClass('is_show');\n\n    });\n\n  };\n\n  GlobalMenu.prototype.submenu_job.show = function() {\n    let _ = this;\n    _.init_submenu(event_obj);\n\n    $(_.$elem)\n    .find(submenu)\n      .on('mouseover', function(){\n        $(this)\n          .addClass('is_show');\n    });\n\n  };\n\n\n  /** --------------------------------------\n   * change accordion menu width\n   *--------------------------------------*/\n  GlobalMenu.prototype.change_accordion_menu_width = function() {\n    let _ = this\n      , _s = _.settings\n      , _a = _s.submenu.accordion\n      , li_anchor = $(_.$elem)\n        .find('.' + _a.body + ' li a')\n    ;\n\n    $(_.$elem).find('.' + _a.body).each(function(){\n      $(this).css(\n        'width'\n        , _.get_accordion_menu_width(\n\n          $(this).children('li'),\n          {\n            'font_size' : li_anchor.css('font-size'),\n            'letter_spacing' : li_anchor.css('letter-spacing'),\n            'padding_left' : li_anchor.css('padding-right'),\n            'padding_right' : li_anchor.css('padding-left')\n          }\n\n        )\n\n      );\n    });\n\n  };\n\n  GlobalMenu.prototype.get_accordion_menu_width = function(list_items, css_obj) {\n    let _ = this\n      , _s = _.settings\n      , _a = _s.submenu.accordion\n      , width = _a.menu_width.min_width\n      , max_width = _a.menu_width.max_width\n    ;\n\n    list_items.each(function(){\n      let span = document.createElement('span');\n      $(span).css({\n        'font-size' : css_obj.font_size,\n        'letter-spacing' : css_obj.letter_spacing,\n        'padding-left' : css_obj.padding_left,\n        'padding-right' : css_obj.padding_right,\n        'display' : 'none',\n        'white-space' : 'nowrap'\n      });\n\n      $(span).append($(this).text());\n      $('body').append(span);\n\n      //小数点が切捨てられるため\n      let span_outer_width = $(span).outerWidth();\n\n      if(width < span_outer_width){\n        width = span_outer_width;\n      }\n\n      if(\n        max_width > 0\n        && max_width < span_outer_width\n      ){\n        width = max_width;\n        return;\n      }\n\n      $(span).remove();\n    });\n\n    return width;\n\n  }\n\n  /** --------------------------------------\n   * position fixed\n   *--------------------------------------*/\n  GlobalMenu.prototype.gm_position_fixed = function() {\n    let _s = this.settings\n      , _sf = _s.scroll_fix\n      , is_fixed = _sf.is_fixed\n      , gm_inner = $(_.$elem).find('.' + _s.gm_inner)\n    ;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n        gm_inner.addClass(is_fixed);\n\n      }else{\n        gm_inner.removeClass(is_fixed);\n      }\n    });\n  }\n\n  GlobalMenu.prototype.gm_position_fixed_view_out = function() {\n    let _s = this.settings\n      , _sf = _s.scroll_fix\n      , is_fixed = _sf.is_fixed\n      , gm_inner = $(_.$elem).find('.' + _s.gm_inner)\n      , is_view_out = _sf.view_out.is_view_out\n      , last_position = 0\n      , curr_position = 0\n    ;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n\n        curr_position = $(this).scrollTop();\n\n        if ( curr_position <= last_position ) {\n\n          gm_inner.removeClass(is_view_out);\n          gm_inner.addClass(is_fixed);\n\n        } else {\n          gm_inner.addClass(is_view_out);\n        }\n\n        last_position = curr_position;\n\n      }else{\n        gm_inner.removeClass(is_fixed + ' ' + is_view_out);\n\n      }\n\n    });\n  }\n\n\n\n  /** ----------------------------------------------------------------------------\n   * other\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.get_submenu = function() {\n    let _ = this\n      , _s = _.settings\n      , selector = ''\n      , cnt      = 0\n    ;\n\n    $.each(_s.submenu, function(index, value) {\n      if(cnt >= 1) selector += ', ';\n\n      selector += '.' + value.item;\n      cnt ++;\n    });\n\n    return selector;\n  };\n\n  GlobalMenu.prototype.is_touch_display = function() {\n    return window.ontouchstart !== undefined\n      && 0 < navigator.maxTouchPoints;\n  };\n\n\n\n  /** ----------------------------------------------------------------------------\n   * plugin\n   *----------------------------------------------------------------------------*/\n  $.fn.global_menu = function(options){\n    let _ = new GlobalMenu(this, options);\n    _.global_menu();\n\n    return(this);\n  };\n})(jQuery);\n"],"names":["$","let","GlobalMenu","elem","settings","this","$elem","extend","gm_area","gm_inner","submenu","is_active","accordion","item","body","menu_width","min_width","max_width","mega","scroll_fix","active_y","parseInt","offset","top","height","is_fixed","view_out","is_view_out","init_on_load","prototype","_","addClass","window","trigger","global_menu","_s","add_submenu_job","change_accordion_menu_width","gm_position_fixed_view_out","gm_position_fixed","init_submenu","event_obj","find","get_submenu","each","removeClass","submenu_job","is_touch_display","on","toggle","flag","setTimeout","toggleClass","show","_a","li_anchor","css","get_accordion_menu_width","children","font_size","letter_spacing","padding_left","padding_right","list_items","css_obj","width","span","document","createElement","span_outer_width","font-size","letter-spacing","padding-left","padding-right","display","white-space","append","text","outerWidth","remove","_sf","scrollTop","last_position","curr_position","selector","cnt","index","value","undefined","ontouchstart","navigator","maxTouchPoints","fn","options","jQuery"],"mappings":"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"}