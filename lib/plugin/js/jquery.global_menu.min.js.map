{"version":3,"file":"jquery.global_menu.min.js","sources":["plugin/js/jquery.global_menu.js"],"sourcesContent":["(function($) {\n  'use strict';\n\n  let GlobalMenu = {};\n  GlobalMenu = (function(elem, settings) {\n\n    // fixed value settings\n    this.settings = $.extend(true, {\n      elem : elem\n      , gm_area : 'gm_area'\n      , gm_inner : 'gm_inner'\n      , is_preloaded : 'is_preloaded'\n      , is_show : 'is_show'\n      , submenu : {\n        is_active : false\n        , accordion : {\n          item : 'gm_accordion'\n          , body : 'gm_accordion_body'\n          , menu_width : {\n            is_active : false\n            , min_width : 220\n            , max_width : 350\n          }\n        }\n        , mega : {\n          item : 'gm_mega'\n          , body : 'gm_mega_body'\n        }\n      }\n      , scroll_fix : {\n        is_active : false\n        , active_y : parseInt($(elem).offset().top + $(elem).height())\n        , is_fixed : 'is_fixed'\n        , view_out : {\n          is_active : false\n          , is_view_out : 'is_view_out'\n        }\n      }\n    }, settings);\n\n    this.init_on_load();\n  });\n\n\n  /** ----------------------------------------------------------------------------\n   * init on load\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.init_on_load = function() {\n    let _ = this;\n    _.prevent_animation();\n\n    if(_.settings.scroll_fix.is_active) {\n      _.trigger_scroll();\n    }\n  };\n\n  /** --------------------------------------\n   * init methods\n   *--------------------------------------*/\n  GlobalMenu.prototype.prevent_animation = function() {\n    let _s = this.settings;\n\n    _s.elem.addClass(_s.is_preloaded);\n  };\n\n  // for scroll fix\n  GlobalMenu.prototype.trigger_scroll = function() {\n    $(window).trigger('scroll');\n  }\n\n\n  /** ----------------------------------------------------------------------------\n   * global menu\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.global_menu = function() {\n    let _        = this\n      , _submenu = _.settings.submenu\n      , _scroll_fix = _.settings.scroll_fix\n    ;\n\n    if(_submenu.is_active){\n      _.submenu();\n\n      if(_submenu.accordion.menu_width.is_active){\n        _.change_accordion_menu_width();\n      }\n    }\n\n    if(_scroll_fix.is_active){\n      if(_scroll_fix.view_out.is_active){\n        _.position_fixed_view_out();\n      }else{\n        _.position_fixed();\n      }\n    }\n\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * sub menu\n   *----------------------------------------------------------------------------*/\n  /** --------------------------------------\n   * sub menu\n   *--------------------------------------*/\n  GlobalMenu.prototype.init_submenu = function(event_obj = '') {\n    let _ = this;\n\n    $(_.settings.elem)\n      .find(_.get_submenu(_.settings.submenu))\n        .each(function(){\n\n          if(event_obj && this == event_obj) return;\n\n          $(this)\n            .removeClass(_.settings.is_show);\n    });\n  };\n\n  GlobalMenu.prototype.submenu = function() {\n    let _         = this\n      , _s        = _.settings\n      , submenu   = _.get_submenu(_s.submenu)\n    ;\n\n    if(_.is_touch_display()){\n\n      let flag = true;\n      $(_s.elem)\n        .find(submenu)\n          .on('click', function(){\n            if(flag == false) return;\n            flag = false;\n            setTimeout(function(){ flag = true; }, 500);\n\n            _.toggle_submenu(this);\n\n      });\n\n      return;\n    }\n\n    $(_s.elem)\n      .find(submenu)\n        .on('mouseover', function(){\n          _.show_submenu(this);\n    });\n\n    $(_s.elem)\n      .on('mouseleave', function(){\n        _.init_submenu();\n    });\n\n  };\n\n  GlobalMenu.prototype.toggle_submenu = function(event_obj) {\n    let _ = this;\n    _.init_submenu(event_obj);\n\n    $(event_obj).toggleClass(\n      _.settings.is_show\n    );\n  };\n\n  GlobalMenu.prototype.show_submenu = function(event_obj) {\n    let _ = this;\n    _.init_submenu(event_obj);\n\n    $(event_obj).addClass(\n      _.settings.is_show\n    );\n  };\n\n\n  /** --------------------------------------\n   * change accordion menu width\n   *--------------------------------------*/\n  GlobalMenu.prototype.change_accordion_menu_width = function() {\n    let _ = this\n      , _s = _.settings\n      , _a = _s.submenu.accordion\n      , li_anchor = $(_s.elem)\n        .find('.' + _a.body + ' li a')\n    ;\n\n    $(_s.elem).find('.' + _a.body).each(function(){\n      $(this).css(\n        'width'\n        , _.get_accordion_menu_width(\n\n          $(this).children('li'),\n          {\n            'font_size' : li_anchor.css('font-size'),\n            'letter_spacing' : li_anchor.css('letter-spacing'),\n            'padding_left' : li_anchor.css('padding-right'),\n            'padding_right' : li_anchor.css('padding-left')\n          }\n\n        )\n\n      );\n    });\n\n  };\n\n  GlobalMenu.prototype.get_accordion_menu_width = function(list_items, css_obj) {\n    let _ = this\n      , _s = _.settings\n      , _a = _s.submenu.accordion\n      , width = _a.menu_width.min_width\n      , max_width = _a.menu_width.max_width\n    ;\n\n    list_items.each(function(){\n      let span = document.createElement('span');\n      $(span).css({\n        'font-size' : css_obj.font_size,\n        'letter-spacing' : css_obj.letter_spacing,\n        'padding-left' : css_obj.padding_left,\n        'padding-right' : css_obj.padding_right,\n        'display' : 'none',\n        'white-space' : 'nowrap'\n      });\n\n      $(span).append($(this).text());\n      $('body').append(span);\n\n      //小数点が切捨てられるため\n      let span_outer_width = $(span).outerWidth();\n\n      if(width < span_outer_width){\n        width = span_outer_width;\n      }\n\n      if(\n        max_width > 0\n        && max_width < span_outer_width\n      ){\n        width = max_width;\n        return;\n      }\n\n      $(span).remove();\n    });\n\n    return width;\n\n  }\n\n  /** --------------------------------------\n   * position fixed\n   *--------------------------------------*/\n  GlobalMenu.prototype.position_fixed = function() {\n    let _s = this.settings\n      , _sf = _s.scroll_fix\n      , is_fixed = _sf.is_fixed\n      , gm_inner = $(_s.elem).find('.' + _s.gm_inner)\n    ;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n        gm_inner.addClass(is_fixed);\n\n      }else{\n        gm_inner.removeClass(is_fixed);\n      }\n    });\n  }\n\n  GlobalMenu.prototype.position_fixed_view_out = function() {\n    let _s = this.settings\n      , _sf = _s.scroll_fix\n      , is_fixed = _sf.is_fixed\n      , gm_inner = $(_s.elem).find('.' + _s.gm_inner)\n      , is_view_out = _sf.view_out.is_view_out\n      , last_position = 0\n      , curr_position = 0\n    ;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n\n        curr_position = $(this).scrollTop();\n\n        if ( curr_position <= last_position ) {\n\n          gm_inner.removeClass(is_view_out);\n          gm_inner.addClass(is_fixed);\n\n        } else {\n          gm_inner.addClass(is_view_out);\n        }\n\n        last_position = curr_position;\n\n      }else{\n        gm_inner.removeClass(is_fixed + ' ' + is_view_out);\n\n      }\n\n    });\n  }\n\n\n\n  /** ----------------------------------------------------------------------------\n   * other\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.get_submenu = function(submenu) {\n    let selector = ''\n      , cnt      = 0\n    ;\n\n    $.each(submenu, function(index, value) {\n      if(cnt >= 1) selector += ', ';\n\n      selector += '.' + value.item;\n      cnt ++;\n    });\n\n    return selector;\n  };\n\n  GlobalMenu.prototype.is_touch_display = function() {\n    return window.ontouchstart !== undefined\n      && 0 < navigator.maxTouchPoints;\n  };\n\n\n\n  /** ----------------------------------------------------------------------------\n   * plugin\n   *----------------------------------------------------------------------------*/\n  $.fn.global_menu = function(options){\n    let _ = new GlobalMenu(this, options);\n    _.global_menu();\n\n    return(this);\n  };\n})(jQuery);\n"],"names":["$","let","GlobalMenu","elem","settings","this","extend","gm_area","gm_inner","is_preloaded","is_show","submenu","is_active","accordion","item","body","menu_width","min_width","max_width","mega","scroll_fix","active_y","parseInt","offset","top","height","is_fixed","view_out","is_view_out","init_on_load","prototype","_","prevent_animation","trigger_scroll","_s","addClass","window","trigger","global_menu","_submenu","_scroll_fix","change_accordion_menu_width","position_fixed_view_out","position_fixed","init_submenu","event_obj","find","get_submenu","each","removeClass","is_touch_display","flag","on","setTimeout","toggle_submenu","show_submenu","toggleClass","_a","li_anchor","css","get_accordion_menu_width","children","font_size","letter_spacing","padding_left","padding_right","list_items","css_obj","width","span","document","createElement","span_outer_width","font-size","letter-spacing","padding-left","padding-right","display","white-space","append","text","outerWidth","remove","_sf","scrollTop","last_position","curr_position","selector","cnt","index","value","undefined","ontouchstart","navigator","maxTouchPoints","fn","options","jQuery"],"mappings":"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"}