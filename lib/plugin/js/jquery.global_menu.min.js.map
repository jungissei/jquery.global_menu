{"version":3,"file":"jquery.global_menu.min.js","sources":["plugin/js/jquery.global_menu.js"],"sourcesContent":["(function($) {\n  'use strict';\n\n  let GlobalMenu = {};\n  GlobalMenu = (function(elem, settings) {\n    this.$elem = elem;\n\n    // fixed value settings\n    this.settings = $.extend(true, {\n      submenu : {\n        is_active : false,\n        accordion : {\n          menu_width : {\n            is_active : false,\n            min_width : 220,\n            max_width : 350\n          }\n        }\n      },\n      scroll_fix : {\n        is_active : false,\n        active_y : parseInt($(elem).offset().top + $(elem).height()),\n        view_out : false\n      }\n    }, settings);\n\n\n    // sub menu css class name\n    this.submenu_class = {\n      accordion : {\n        item : 'gm_accordion',\n        body : 'gm_accordion_body',\n      },\n      mega : {\n        item : 'gm_mega',\n        body : 'gm_mega_body'\n      }\n    }\n  });\n\n\n  /** ----------------------------------------------------------------------------\n   * init on load\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.init_on_load = function() {\n    let _ = this,\n        _s = _.settings;\n\n    // prevent animation\n    _.$elem.addClass('is_preloaded');\n\n    // add scroll event when scroll fix is active\n    if(_s.scroll_fix.is_active) {\n      $(window).trigger('scroll');\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * global menu\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.global_menu = function() {\n    let _ = this,\n        _s = _.settings;\n\n    // init on load\n    _.init_on_load();\n\n    if(_s.submenu.is_active){\n      // job for submenu\n      _.manage_submenu();\n\n      if(_s.submenu.accordion.menu_width.is_active){\n        // job for accordion　menu　width\n        _.change_accordion_menu_width();\n      }\n    }\n\n    if(_s.scroll_fix.is_active){\n      if(_s.scroll_fix.view_out.is_active){\n        _.gm_position_fixed_view_out();\n      }else{\n        _.gm_position_fixed();\n      }\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * sub menu\n   *----------------------------------------------------------------------------*/\n  /** --------------------------------------\n   * sub menu\n   *--------------------------------------*/\n  GlobalMenu.prototype.manage_submenu = function() {\n    let _ = this;\n\n    _.submenu_job[\n      _.is_touch_display()? 'click' : 'hover'\n    ](_);\n\n    _.submenu_job.close(_);\n  };\n\n  GlobalMenu.prototype.submenu_job = {\n    init : function(self , event_obj) {\n      let _ = self;\n\n      $(_.$elem).find(_.get_submenu()).each(function(){\n\n        if(\n          typeof event_obj !== 'undefined'\n          && this == event_obj\n        ) return;\n\n        $(this).removeClass('is_show');\n\n      });\n    },\n    click : function(self) {\n      let _ = self,\n          flag = true;\n\n      $(_.$elem).find(_.get_submenu()).on('click', function(){\n        if(flag == false) return;\n        flag = false;\n        setTimeout(function(){ flag = true; }, 500);\n\n        _.submenu_job.init(_, this);\n\n        $(this).toggleClass('is_show');\n\n      });\n    },\n    hover : function(self) {\n      let _ = self;\n\n      $(_.$elem).find(_.get_submenu()).on('mouseover', function(){\n\n        _.submenu_job.init(_, this);\n        $(this).addClass('is_show');\n\n      });\n    },\n    close : function(self) {\n      let _ = self;\n\n      $(_.$elem).on('mouseleave', function(){\n        _.submenu_job.init(_);\n      });\n    }\n  };\n\n\n  /** --------------------------------------\n   * change accordion menu width\n   *--------------------------------------*/\n  GlobalMenu.prototype.change_accordion_menu_width = function() {\n    let _ = this,\n        _s = _.settings,\n        _a = _s.submenu.accordion,\n        li_anchor = $(_.$elem).find('.gm_accordion_body li a');\n\n    $(_.$elem).find('.gm_accordion_body').each(function(){\n      $(this).css(\n        'width'\n        , _.get_accordion_menu_width(\n\n          $(this).children('li'),\n          {\n            'font_size' : li_anchor.css('font-size'),\n            'letter_spacing' : li_anchor.css('letter-spacing'),\n            'padding_left' : li_anchor.css('padding-right'),\n            'padding_right' : li_anchor.css('padding-left')\n          }\n\n        )\n\n      );\n    });\n\n  };\n\n  GlobalMenu.prototype.get_accordion_menu_width = function(list_items, css_obj) {\n    let _ = this,\n        _s = _.settings,\n        width = _s.submenu.accordion.menu_width.min_width,\n        max_width = _s.submenu.accordion.menu_width.max_width;\n\n    list_items.each(function(){\n      let span = document.createElement('span');\n      $(span).css({\n        'font-size' : css_obj.font_size,\n        'letter-spacing' : css_obj.letter_spacing,\n        'padding-left' : css_obj.padding_left,\n        'padding-right' : css_obj.padding_right,\n        'display' : 'none',\n        'white-space' : 'nowrap'\n      });\n\n      $(span).append($(this).text());\n      $('body').append(span);\n\n      //小数点が切捨てられるため\n      let span_outer_width = $(span).outerWidth();\n\n      if(width < span_outer_width){\n        width = span_outer_width;\n      }\n\n      if(\n        max_width > 0\n        && max_width < span_outer_width\n      ){\n        width = max_width;\n        return;\n      }\n\n      $(span).remove();\n    });\n\n    return width;\n\n  }\n\n  /** --------------------------------------\n   * position fixed\n   *--------------------------------------*/\n  GlobalMenu.prototype.gm_position_fixed = function() {\n    let _ = this,\n        _s = _.settings,\n        _sf = _s.scroll_fix,\n        is_fixed = 'is_fixed',\n        gm_inner = $(_.$elem).find('.gm_inner');\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n        gm_inner.addClass(is_fixed);\n\n      }else{\n        gm_inner.removeClass(is_fixed);\n      }\n    });\n  }\n\n  GlobalMenu.prototype.gm_position_fixed_view_out = function() {\n    let _ = this,\n        _s = _.settings,\n        _sf = _s.scroll_fix,\n        is_fixed = 'is_fixed',\n        gm_inner = $(_.$elem).find('.gm_inner'),\n        is_view_out = 'is_view_out',\n        last_position = 0,\n        curr_position = 0;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n\n        curr_position = $(this).scrollTop();\n\n        if ( curr_position <= last_position ) {\n\n          gm_inner.removeClass(is_view_out);\n          gm_inner.addClass(is_fixed);\n\n        } else {\n          gm_inner.addClass(is_view_out);\n        }\n\n        last_position = curr_position;\n\n      }else{\n        gm_inner.removeClass(is_fixed + ' ' + is_view_out);\n\n      }\n\n    });\n  }\n\n\n\n  /** ----------------------------------------------------------------------------\n   * other\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.get_submenu = function() {\n    let _ = this,\n        _s = _.settings,\n        selector = '',\n        cnt = 0;\n\n    $.each(_.submenu_class, function(index, value) {\n      if(cnt >= 1) selector += ', ';\n\n      selector += '.' + value.item;\n      cnt ++;\n    });\n\n    return selector;\n  };\n\n  GlobalMenu.prototype.is_touch_display = function() {\n    return window.ontouchstart !== undefined\n      && 0 < navigator.maxTouchPoints;\n  };\n\n\n\n  /** ----------------------------------------------------------------------------\n   * plugin\n   *----------------------------------------------------------------------------*/\n  $.fn.global_menu = function(options){\n    let _ = new GlobalMenu(this, options);\n    _.global_menu();\n\n    return(this);\n  };\n})(jQuery);\n"],"names":["$","let","GlobalMenu","elem","settings","this","$elem","extend","submenu","is_active","accordion","menu_width","min_width","max_width","scroll_fix","active_y","parseInt","offset","top","height","view_out","submenu_class","item","body","mega","prototype","init_on_load","_s","addClass","window","trigger","global_menu","_","manage_submenu","change_accordion_menu_width","gm_position_fixed_view_out","gm_position_fixed","submenu_job","is_touch_display","close","init","self","event_obj","find","get_submenu","each","removeClass","click","flag","on","setTimeout","toggleClass","hover","li_anchor","css","get_accordion_menu_width","children","font_size","letter_spacing","padding_left","padding_right","list_items","css_obj","width","span","document","createElement","span_outer_width","font-size","letter-spacing","padding-left","padding-right","display","white-space","append","text","outerWidth","remove","_sf","is_fixed","gm_inner","scrollTop","is_view_out","last_position","curr_position","selector","cnt","index","value","undefined","ontouchstart","navigator","maxTouchPoints","fn","options","jQuery"],"mappings":"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"}