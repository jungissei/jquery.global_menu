{"version":3,"file":"jquery.global_menu.min.js","sources":["plugin/js/jquery.global_menu.js"],"sourcesContent":[";(function(factory) {\n  'use strict';\n\n  if (typeof define === 'function' && define.amd) {\n    define(['jquery'], factory);\n  } else if (typeof exports !== 'undefined') {\n    module.exports = factory(require('jquery'));\n  } else {\n    factory(jQuery);\n  }\n\n}(function($) {\n  'use strict';\n\n  let GlobalMenu = {};\n  GlobalMenu = (function() {\n    let instance_uid = 0;\n\n    function GlobalMenu(elem, settings) {\n      let _ = this;\n\n      _.$elem = $(elem);\n\n      // fixed value settings\n      _.settings = $.extend(true, {\n        submenu : {\n          is_active : false,\n          accordion : {\n            menu_width : {\n              is_active : false,\n              min_width : 220,\n              max_width : 350\n            }\n          }\n        },\n        scroll_fix : {\n          is_active : false,\n          active_y : parseInt($(elem).offset().top + $(elem).height()),\n          view_out : false\n        }\n      }, settings);\n\n\n      // sub menu css class name\n      _.submenu_class = {\n        accordion : {\n          item : 'gm_accordion',\n          body : 'gm_accordion_body',\n        },\n        mega : {\n          item : 'gm_mega',\n          body : 'gm_mega_body'\n        }\n      }\n\n      _.instance_uid = instance_uid++;\n\n      // init on load\n      _.init_on_load();\n\n      _.global_menu();\n    }\n\n    return GlobalMenu;\n  }());\n\n\n\n  /** ----------------------------------------------------------------------------\n   * init on load\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.init_on_load = function() {\n    let _ = this;\n\n    // prevent animation\n    _.$elem.addClass('is_preloaded');\n\n    // add scroll event when scroll fix is active\n    if(_.settings.scroll_fix.is_active) {\n      $(window).trigger('scroll');\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * global menu\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.global_menu = function() {\n    let _ = this;\n\n    if(_.settings.submenu.is_active){\n      // job for submenu\n      _.manage_submenu();\n\n      if(_.settings.submenu.accordion.menu_width.is_active){\n\n        // job for accordion　menu　width\n        _.change_accordion_menu_width();\n      }\n    }\n\n    if(_.settings.scroll_fix.is_active){\n      if(_.settings.scroll_fix.view_out.is_active){\n        _.gm_position_fixed_view_out();\n      }else{\n        _.gm_position_fixed();\n      }\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * sub menu\n   *----------------------------------------------------------------------------*/\n  /** --------------------------------------\n   * sub menu\n   *--------------------------------------*/\n  GlobalMenu.prototype.manage_submenu = function() {\n    let _ = this;\n\n    _.submenu_job[\n      _.is_touch_display()? 'click' : 'hover'\n    ].bind(_)();\n\n    _.submenu_job.close.bind(_)();\n  };\n\n  GlobalMenu.prototype.submenu_job = {\n    init : function(event_obj) {\n      let _ = this;\n\n      $(_.$elem).find(_.get_submenu()).each(function(){\n\n        if(\n          typeof event_obj !== 'undefined'\n          && this == event_obj\n        ) return;\n\n        $(this).removeClass('is_show');\n\n      });\n    },\n    click : function() {\n      let _ = this,\n          flag = true;\n\n      $(_.$elem).find(_.get_submenu()).on('click', function(e){\n        e.preventDefault();\n\n        if(flag == false) return;\n        flag = false;\n        setTimeout(function(){ flag = true; }, 500);\n\n        _.submenu_job.init.bind(_)(this);\n\n        $(this).toggleClass('is_show');\n\n      });\n    },\n    hover : function() {\n      let _ = this;\n\n      $(_.$elem).find(_.get_submenu()).on('mouseover', function(){\n\n        _.submenu_job.init.bind(_)(this);\n        $(this).addClass('is_show');\n\n      });\n    },\n    close : function() {\n      let _ = this;\n\n      $(_.$elem).on('mouseleave', function(){\n        _.submenu_job.init.bind(_)();\n      });\n    }\n  };\n\n\n  /** --------------------------------------\n   * change accordion menu width\n   *--------------------------------------*/\n  GlobalMenu.prototype.change_accordion_menu_width = function() {\n    let _ = this,\n        _s = _.settings,\n        _a = _s.submenu.accordion,\n        li_anchor = $(_.$elem).find('.gm_accordion_body li a');\n\n    $(_.$elem).find('.gm_accordion_body').each(function(){\n      $(this).css(\n        'width'\n        , _.get_accordion_menu_width(\n\n          $(this).children('li'),\n          {\n            'font_size' : li_anchor.css('font-size'),\n            'letter_spacing' : li_anchor.css('letter-spacing'),\n            'padding_left' : li_anchor.css('padding-right'),\n            'padding_right' : li_anchor.css('padding-left')\n          }\n\n        )\n\n      );\n    });\n\n  };\n\n  GlobalMenu.prototype.get_accordion_menu_width = function(list_items, css_obj) {\n    let _ = this,\n        _s = _.settings,\n        width = _s.submenu.accordion.menu_width.min_width,\n        max_width = _s.submenu.accordion.menu_width.max_width;\n\n    list_items.each(function(){\n      let span = document.createElement('span');\n      $(span).css({\n        'font-size' : css_obj.font_size,\n        'letter-spacing' : css_obj.letter_spacing,\n        'padding-left' : css_obj.padding_left,\n        'padding-right' : css_obj.padding_right,\n        'display' : 'none',\n        'white-space' : 'nowrap'\n      });\n\n      $(span).append($(this).text());\n      $('body').append(span);\n\n      //小数点が切捨てられるため\n      let span_outer_width = $(span).outerWidth();\n\n      if(width < span_outer_width){\n        width = span_outer_width;\n      }\n\n      if(\n        max_width > 0\n        && max_width < span_outer_width\n      ){\n        width = max_width;\n        return;\n      }\n\n      $(span).remove();\n    });\n\n    return width;\n\n  }\n\n  /** --------------------------------------\n   * position fixed\n   *--------------------------------------*/\n  GlobalMenu.prototype.gm_position_fixed = function() {\n    let _ = this,\n        _s = _.settings,\n        _sf = _s.scroll_fix,\n        is_fixed = 'is_fixed',\n        gm_inner = $(_.$elem).find('.gm_inner');\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n        gm_inner.addClass(is_fixed);\n\n      }else{\n        gm_inner.removeClass(is_fixed);\n      }\n    });\n  }\n\n  GlobalMenu.prototype.gm_position_fixed_view_out = function() {\n    let _ = this,\n        _s = _.settings,\n        _sf = _s.scroll_fix,\n        is_fixed = 'is_fixed',\n        gm_inner = $(_.$elem).find('.gm_inner'),\n        is_view_out = 'is_view_out',\n        last_position = 0,\n        curr_position = 0;\n\n    $(window).on('scroll', function(){\n      if(_sf.active_y < $(window).scrollTop()){\n\n        curr_position = $(this).scrollTop();\n\n        if ( curr_position <= last_position ) {\n\n          gm_inner.removeClass(is_view_out);\n          gm_inner.addClass(is_fixed);\n\n        } else {\n          gm_inner.addClass(is_view_out);\n        }\n\n        last_position = curr_position;\n\n      }else{\n        gm_inner.removeClass(is_fixed + ' ' + is_view_out);\n\n      }\n\n    });\n  }\n\n\n\n  /** ----------------------------------------------------------------------------\n   * other\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.get_submenu = function() {\n    let _ = this,\n        _s = _.settings,\n        selector = '',\n        cnt = 0;\n\n    $.each(_.submenu_class, function(index, value) {\n      if(cnt >= 1) selector += ', ';\n\n      selector += '.' + value.item;\n      cnt ++;\n    });\n\n    return selector;\n  };\n\n  GlobalMenu.prototype.is_touch_display = function() {\n    return window.ontouchstart !== undefined\n      && 0 < navigator.maxTouchPoints;\n  };\n\n\n\n  /** ----------------------------------------------------------------------------\n   * Plugin wrapper\n   *----------------------------------------------------------------------------*/\n  /**\n   * @return {any} plugin method return value\n   * @return {object} options\n   */\n  $.fn.global_menu = function(options){\n    let _ = this,\n        opt = arguments[0],\n        args = Array.prototype.slice.call(arguments, 1),\n        l = _.length,\n        i,\n        ret;\n\n    for (i = 0; i < l; i++) {\n\n      if (typeof opt == 'object' || typeof opt == 'undefined'){\n\n        // Initialize the plugin\n        _[i].global_menu = new GlobalMenu(_[i], opt);\n\n      }else{\n\n        // Call method on the plugin instance\n        ret = _[i].global_menu[opt].apply(_[i].global_menu, args);\n\n        // When method has return job, return it\n        if (typeof ret != 'undefined') return ret;\n      }\n\n    };\n\n    // options object\n    return _;\n\n  };\n}));\n"],"names":["factory","define","amd","exports","module","require","jQuery","$","let","GlobalMenu","instance_uid","elem","settings","_","this","$elem","extend","submenu","is_active","accordion","menu_width","min_width","max_width","scroll_fix","active_y","parseInt","offset","top","height","view_out","submenu_class","item","body","mega","init_on_load","global_menu","prototype","addClass","window","trigger","manage_submenu","change_accordion_menu_width","gm_position_fixed_view_out","gm_position_fixed","submenu_job","is_touch_display","bind","close","init","event_obj","find","get_submenu","each","removeClass","click","flag","on","e","preventDefault","setTimeout","toggleClass","hover","_s","li_anchor","css","get_accordion_menu_width","children","font_size","letter_spacing","padding_left","padding_right","list_items","css_obj","width","span","document","createElement","span_outer_width","font-size","letter-spacing","padding-left","padding-right","display","white-space","append","text","outerWidth","remove","_sf","is_fixed","gm_inner","scrollTop","is_view_out","last_position","curr_position","selector","cnt","index","value","undefined","ontouchstart","navigator","maxTouchPoints","fn","options","opt","args","Array","slice","call","arguments","l","length","i","ret","apply"],"mappings":"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"}