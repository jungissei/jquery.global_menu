{"version":3,"file":"jquery.global_menu.min.js","sources":["plugin/js/jquery.global_menu.js"],"sourcesContent":[";(function(factory) {\n  'use strict';\n\n  if (typeof define === 'function' && define.amd) {\n    define(['jquery'], factory);\n  } else if (typeof exports !== 'undefined') {\n    module.exports = factory(require('jquery'));\n  } else {\n    factory(jQuery);\n  }\n\n}(function($) {\n  'use strict';\n\n  let GlobalMenu = {};\n  GlobalMenu = (function() {\n    let instance_uid = 0;\n\n    function GlobalMenu(elem, settings) {\n      let _ = this;\n\n      _.$elem = $(elem);\n\n      // fixed value settings\n      _.settings = $.extend(true, {\n        submenu : {\n          is_active : false,\n          accordion : {\n            menu_width : {\n              is_active : false,\n              min_width : 220,\n              max_width : 350\n            }\n          }\n        },\n        scroll_fix : {\n          is_active : false\n        }\n      }, settings);\n\n\n      // sub menu css class name\n      _.submenu_class = {\n        accordion : {\n          item : 'gm_accordion',\n          body : 'gm_accordion_body',\n        },\n        mega : {\n          item : 'gm_mega',\n          body : 'gm_mega_body'\n        }\n      }\n\n      _.instance_uid = instance_uid++;\n      _.fixed_active_position;\n\n\n      // init on load\n      _.init_on_load();\n\n      _.global_menu();\n    }\n\n    return GlobalMenu;\n  }());\n\n\n\n  /** ----------------------------------------------------------------------------\n   * init on load\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.init_on_load = function() {\n    let _ = this;\n\n    // prevent animation\n    _.$elem.addClass('is_preloaded');\n\n    // add scroll event when scroll fix is active\n    if(_.settings.scroll_fix.is_active) {\n      $(window).trigger('scroll');\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * global menu\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.global_menu = function() {\n    let _ = this;\n\n    if(_.settings.submenu.is_active){\n      // job for submenu\n      _.manage_submenu();\n\n      if(_.settings.submenu.accordion.menu_width.is_active){\n\n        // job for accordion　menu　width\n        _.change_accordion_menu_width();\n      }\n    }\n\n    if(_.settings.scroll_fix.is_active){\n      _.gm_position_fixed_show_hide();\n    }\n  };\n\n\n  /** ----------------------------------------------------------------------------\n   * sub menu\n   *----------------------------------------------------------------------------*/\n  /** --------------------------------------\n   * sub menu\n   *--------------------------------------*/\n  GlobalMenu.prototype.manage_submenu = function() {\n    let _ = this;\n\n    _.submenu_job[\n      _.is_touch_display()? 'click' : 'hover'\n    ].bind(_)();\n\n    _.submenu_job.close.bind(_)();\n  };\n\n  GlobalMenu.prototype.submenu_job = {\n    init : function(event_obj) {\n      let _ = this;\n\n      $(_.$elem).find(_.get_submenu()).each(function(){\n\n        if(\n          typeof event_obj !== 'undefined'\n          && this == event_obj\n        ) return;\n\n        $(this).removeClass('is_show');\n\n      });\n    },\n    click : function() {\n      let _ = this,\n          flag = true;\n\n      $(_.$elem).find(_.get_submenu()).on('click', function(e){\n        e.preventDefault();\n\n        if(flag == false) return;\n        flag = false;\n        setTimeout(function(){ flag = true; }, 500);\n\n        _.submenu_job.init.bind(_)(this);\n\n        $(this).toggleClass('is_show');\n\n      });\n    },\n    hover : function() {\n      let _ = this;\n\n      $(_.$elem).find(_.get_submenu()).on('mouseover', function(){\n\n        _.submenu_job.init.bind(_)(this);\n        $(this).addClass('is_show');\n\n      });\n    },\n    close : function() {\n      let _ = this;\n\n      $(_.$elem).on('mouseleave', function(){\n        _.submenu_job.init.bind(_)();\n      });\n    }\n  };\n\n\n  /** --------------------------------------\n   * change accordion menu width\n   *--------------------------------------*/\n  GlobalMenu.prototype.change_accordion_menu_width = function() {\n    let _ = this,\n        _s = _.settings,\n        _a = _s.submenu.accordion,\n        li_anchor = $(_.$elem).find('.gm_accordion_body li a');\n\n    $(_.$elem).find('.gm_accordion_body').each(function(){\n      $(this).css(\n        'width'\n        , _.get_accordion_menu_width(\n\n          $(this).children('li'),\n          {\n            'font_size' : li_anchor.css('font-size'),\n            'letter_spacing' : li_anchor.css('letter-spacing'),\n            'padding_left' : li_anchor.css('padding-right'),\n            'padding_right' : li_anchor.css('padding-left')\n          }\n\n        )\n\n      );\n    });\n\n  };\n\n  GlobalMenu.prototype.get_accordion_menu_width = function(list_items, css_obj) {\n    let _ = this,\n        _s = _.settings,\n        width = _s.submenu.accordion.menu_width.min_width,\n        max_width = _s.submenu.accordion.menu_width.max_width;\n\n    list_items.each(function(){\n      let span = document.createElement('span');\n      $(span).css({\n        'font-size' : css_obj.font_size,\n        'letter-spacing' : css_obj.letter_spacing,\n        'padding-left' : css_obj.padding_left,\n        'padding-right' : css_obj.padding_right,\n        'display' : 'none',\n        'white-space' : 'nowrap'\n      });\n\n      $(span).append($(this).text());\n      $('body').append(span);\n\n      //小数点が切捨てられるため\n      let span_outer_width = $(span).outerWidth();\n\n      if(width < span_outer_width){\n        width = span_outer_width;\n      }\n\n      if(\n        max_width > 0\n        && max_width < span_outer_width\n      ){\n        width = max_width;\n        return;\n      }\n\n      $(span).remove();\n    });\n\n    return width;\n\n  }\n\n  /** --------------------------------------\n   * position fixed show/hide by scroll up down\n   *--------------------------------------*/\n  GlobalMenu.prototype.gm_position_fixed_show_hide = function() {\n    let _ = this,\n        curr_position,\n        last_position = $(window).scrollTop();\n\n    _.fixed_active_position = parseInt(_.$elem.offset().top + _.$elem.height());\n\n    $(window).on('scroll', function(){\n      curr_position = $(this).scrollTop();\n\n      _.gm_scroll_fixed_show_hide_jobs[\n        _.fixed_active_position < curr_position?\n          'fixed' : 'unfixed'\n      ].bind(_)();\n\n      if(\n        _.fixed_active_position < curr_position &&\n        last_position !== curr_position\n      ){\n        _.gm_scroll_fixed_show_hide_jobs[\n          last_position < curr_position?\n            'hide' : 'show'\n        ].bind(_)();\n      }\n\n      last_position = curr_position;\n    });\n  }\n\n  GlobalMenu.prototype.gm_scroll_fixed_show_hide_jobs = {\n    unfixed : function(){\n      let _ = this;\n\n      _.fixed_active_position = parseInt(_.$elem.offset().top + _.$elem.height());\n\n      _.$elem.find('.gm_inner')\n        .removeClass('is_fixed is_scroll_hide is_scroll_show')\n        .css({\n          'transition' : '',\n          'margin-top' : ''\n        });\n\n      _.$elem.css({\n        'height' : ''\n      });\n\n      _.$elem.trigger('global_menu_unfixed');\n    },\n    fixed : function(){\n      let _ = this;\n\n      _.fixed_active_position = parseInt(_.$elem.offset().top);\n\n      _.$elem.css('height', _.$elem.height());\n\n      _.$elem.find('.gm_inner')\n        .addClass('is_fixed');\n\n      _.$elem.trigger('global_menu_fixed');\n    },\n    show : function(){\n      let _ = this;\n\n      _.$elem.find('.gm_inner')\n        .removeClass('is_scroll_hide')\n        .addClass('is_scroll_show')\n        .css({\n          'transition' : 'margin-top 0.2s',\n          'margin-top' : 0\n        });\n\n      _.$elem.trigger('global_menu_scroll_show');\n    },\n    hide : function(){\n      let _ = this,\n          $inner = _.$elem.find('.gm_inner');\n\n      $inner\n        .removeClass('is_scroll_show')\n        .addClass('is_scroll_hide')\n        .css('margin-top', -($inner.outerHeight()));\n\n\n      _.$elem.trigger('global_menu_scroll_hide');\n    }\n  }\n\n\n\n\n\n  /** ----------------------------------------------------------------------------\n   * other\n   *----------------------------------------------------------------------------*/\n  GlobalMenu.prototype.get_submenu = function() {\n    let _ = this,\n        selector = '',\n        cnt = 0;\n\n    $.each(_.submenu_class, function(index, value) {\n      if(cnt >= 1) selector += ', ';\n\n      selector += '.' + value.item;\n      cnt ++;\n    });\n\n    return selector;\n  };\n\n  GlobalMenu.prototype.is_touch_display = function() {\n    return window.ontouchstart !== undefined\n      && 0 < navigator.maxTouchPoints;\n  };\n\n\n\n  /** ----------------------------------------------------------------------------\n   * Plugin wrapper\n   *----------------------------------------------------------------------------*/\n  /**\n   * @return {any} plugin method return value\n   * @return {object} options\n   */\n  $.fn.global_menu = function(){\n    let _ = this,\n        opt = arguments[0],\n        args = Array.prototype.slice.call(arguments, 1),\n        l = _.length,\n        i,\n        ret;\n\n    for (i = 0; i < l; i++) {\n\n      if (typeof opt == 'object' || typeof opt == 'undefined'){\n\n        // Initialize the plugin\n        _[i].global_menu = new GlobalMenu(_[i], opt);\n\n      }else{\n\n        // Call method on the plugin instance\n        ret = _[i].global_menu[opt].apply(_[i].global_menu, args);\n\n        // When method has return job, return it\n        if (typeof ret != 'undefined') return ret;\n      }\n\n    };\n\n    // options object\n    return _;\n\n  };\n}));\n"],"names":["factory","define","amd","exports","module","require","jQuery","$","let","GlobalMenu","instance_uid","elem","settings","_","this","$elem","extend","submenu","is_active","accordion","menu_width","min_width","max_width","scroll_fix","submenu_class","item","body","mega","fixed_active_position","init_on_load","global_menu","prototype","addClass","window","trigger","manage_submenu","change_accordion_menu_width","gm_position_fixed_show_hide","submenu_job","is_touch_display","bind","close","init","event_obj","find","get_submenu","each","removeClass","click","flag","on","e","preventDefault","setTimeout","toggleClass","hover","_s","li_anchor","css","get_accordion_menu_width","children","font_size","letter_spacing","padding_left","padding_right","list_items","css_obj","width","span","document","createElement","span_outer_width","font-size","letter-spacing","padding-left","padding-right","display","white-space","append","text","outerWidth","remove","curr_position","last_position","scrollTop","parseInt","offset","top","height","gm_scroll_fixed_show_hide_jobs","unfixed","transition","margin-top","fixed","show","hide","$inner","outerHeight","selector","cnt","index","value","undefined","ontouchstart","navigator","maxTouchPoints","fn","opt","arguments","args","Array","slice","call","l","length","i","ret","apply"],"mappings":"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"}